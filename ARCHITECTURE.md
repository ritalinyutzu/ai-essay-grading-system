# AI 作文自動批改系統 - 架構設計

## 系統概述

基於 ICR (Intelligent Character Recognition) 技術的作文自動批改系統，完整流程包含：
1. 作文圖片輸入
2. ICR 文字辨識
3. AI 評分
4. 評估指標分析（Confusion Matrix, F1, Recall, Precision）

---

## 系統架構

```
輸入層（Image Input）
    ↓
前處理層（Preprocessing）
    ├─ 影像增強
    ├─ 去噪
    └─ 傾斜校正
    ↓
ICR 辨識層（Text Recognition）
    ├─ OCR Engine（Tesseract/EasyOCR/PaddleOCR）
    ├─ 手寫文字辨識
    └─ 後處理與校正
    ↓
NLP 分析層（Text Analysis）
    ├─ 文法檢查
    ├─ 用詞分析
    ├─ 結構分析
    └─ 內容評估
    ↓
評分層（Scoring）
    ├─ 多維度評分
    │   ├─ 內容（Content）
    │   ├─ 結構（Structure）
    │   ├─ 文法（Grammar）
    │   └─ 用詞（Vocabulary）
    └─ 綜合評分
    ↓
評估層（Evaluation）
    ├─ Confusion Matrix
    ├─ Precision
    ├─ Recall
    └─ F1 Score
```

---

## 技術棧

### ICR / OCR 選擇

| 技術 | 優點 | 缺點 | 適用場景 |
|------|------|------|---------|
| **Tesseract** | 免費、支援多語言 | 手寫辨識較差 | 印刷體 |
| **EasyOCR** | 易用、支援80+語言 | 速度較慢 | 手寫+印刷 |
| **PaddleOCR** | 快速、準確度高 | 中文特化 | 中文作文 |
| **Google Vision API** | 準確度最高 | 需付費 | 商業應用 |
| **Azure Computer Vision** | 企業級 | 需付費 | 大規模應用 |

**推薦：PaddleOCR（中文）或 EasyOCR（多語言）**

---

### NLP 評分技術

| 方法 | 說明 | 優點 | 缺點 |
|------|------|------|------|
| **規則基礎** | 預設規則評分 | 可解釋性強 | 不夠靈活 |
| **傳統 ML** | SVM, Random Forest | 速度快 | 需要大量特徵工程 |
| **BERT-based** | 使用 BERT 評分 | 準確度高 | 需要訓練資料 |
| **GPT-based** | 使用 GPT 評分 | 最靈活、最準確 | 成本高 |

**推薦：BERT + 規則混合模式**

---

## 評分標準

### 多維度評分體系

```python
評分維度 = {
    "內容": {
        "權重": 0.35,
        "子項目": {
            "主題切合度": 0.4,
            "論點完整性": 0.3,
            "論證充分性": 0.3
        }
    },
    "結構": {
        "權重": 0.25,
        "子項目": {
            "結構完整性": 0.4,
            "段落安排": 0.3,
            "邏輯連貫性": 0.3
        }
    },
    "文法": {
        "權重": 0.25,
        "子項目": {
            "文法正確性": 0.5,
            "標點使用": 0.25,
            "錯別字": 0.25
        }
    },
    "用詞": {
        "權重": 0.15,
        "子項目": {
            "詞彙豐富度": 0.4,
            "用詞準確性": 0.3,
            "修辭技巧": 0.3
        }
    }
}
```

### 等級劃分

| 等級 | 分數範圍 | 說明 |
|------|---------|------|
| A+ | 90-100 | 優秀 |
| A | 80-89 | 良好 |
| B | 70-79 | 中等偏上 |
| C | 60-69 | 及格 |
| D | 50-59 | 中等偏下 |
| F | 0-49 | 不及格 |

---

## 評估指標

### Confusion Matrix（混淆矩陣）

對於多分類問題（A+, A, B, C, D, F）：

```
                預測
實際    A+   A    B    C    D    F
A+      50   3    0    0    0    0
A        2  45    5    0    0    0
B        0   4   40    3    0    0
C        0   0    5   38    2    0
D        0   0    0    3   35    2
F        0   0    0    0    2   28
```

### 評估指標計算

**對於每個等級 i：**

```
Precision_i = TP_i / (TP_i + FP_i)
Recall_i = TP_i / (TP_i + FN_i)
F1_i = 2 × (Precision_i × Recall_i) / (Precision_i + Recall_i)
```

**整體指標（Macro Average）：**

```
Precision_macro = Σ(Precision_i) / n
Recall_macro = Σ(Recall_i) / n
F1_macro = Σ(F1_i) / n
```

**整體指標（Weighted Average）：**

```
Precision_weighted = Σ(Precision_i × Support_i) / Σ(Support_i)
```

---

## 系統流程圖

```
1. 圖片輸入
   └─ 格式：JPG, PNG, PDF
   └─ 要求：解析度 > 300 DPI

2. 前處理
   ├─ 灰階轉換
   ├─ 二值化
   ├─ 去噪（高斯模糊）
   ├─ 傾斜校正
   └─ 邊緣檢測與裁切

3. ICR 辨識
   ├─ 文字區域檢測
   ├─ 字元切分
   ├─ 字元辨識
   └─ 文字重組

4. 後處理
   ├─ 拼寫檢查
   ├─ 語法修正
   └─ 標點校正

5. NLP 分析
   ├─ 分詞（Tokenization）
   ├─ 詞性標註（POS Tagging）
   ├─ 句法分析（Parsing）
   ├─ 語意分析（Semantic Analysis）
   └─ 情感分析（Sentiment Analysis）

6. 特徵提取
   ├─ 字數統計
   ├─ 句子數量
   ├─ 段落數量
   ├─ 詞彙豐富度（TTR）
   ├─ 平均句長
   ├─ 錯字率
   └─ 文法錯誤數

7. 評分
   ├─ 規則評分
   ├─ 模型評分
   └─ 混合評分

8. 輸出
   ├─ 總分
   ├─ 分項分數
   ├─ 詳細評語
   └─ 改進建議

9. 評估
   ├─ Confusion Matrix
   ├─ Precision / Recall / F1
   └─ 準確率分析
```

---

## 資料集需求

### 訓練資料

**需要收集：**

1. **作文圖片**
   - 數量：1,000-5,000 張
   - 包含：手寫 + 打字
   - 各種筆跡風格

2. **人工評分**
   - 至少 2-3 位老師評分
   - 包含詳細評語
   - 分項分數

3. **標準答案**（可選）
   - 範文參考
   - 評分標準

### 資料標註格式

```json
{
  "essay_id": "001",
  "image_path": "essays/001.jpg",
  "ocr_text": "辨識出的文字...",
  "manual_text": "人工校正的文字...",
  "scores": {
    "content": 32,
    "structure": 22,
    "grammar": 23,
    "vocabulary": 13,
    "total": 90
  },
  "grade": "A+",
  "annotations": {
    "strengths": ["論點清晰", "結構完整"],
    "weaknesses": ["用詞略顯平淡"],
    "suggestions": ["可以使用更多修辭手法"]
  }
}
```

---

## 技術挑戰

### 1. ICR 辨識挑戰

| 挑戰 | 解決方案 |
|------|---------|
| 手寫辨識準確度低 | 使用專門的手寫辨識模型（如 CRNN） |
| 字跡潦草難辨 | 增強前處理、使用語言模型輔助校正 |
| 多種書寫風格 | 收集多樣化訓練資料 |
| 圖片品質差 | 影像增強技術、超解析度 |

### 2. 評分挑戰

| 挑戰 | 解決方案 |
|------|---------|
| 主觀性強 | 多位評分者標註、使用一致性檢驗 |
| 評分標準不一 | 建立詳細評分細則 |
| 創意難量化 | 結合規則與模型 |

### 3. 效能挑戰

| 挑戰 | 解決方案 |
|------|---------|
| 處理速度慢 | GPU 加速、批次處理 |
| 記憶體佔用大 | 分段處理、模型壓縮 |
| 即時性要求 | 使用輕量化模型 |

---

## 系統優勢

### vs 傳統人工批改

| 項目 | 人工批改 | AI 批改 |
|------|---------|---------|
| **速度** | 5-10 分鐘/篇 | 10-30 秒/篇 |
| **成本** | $5-10/篇 | $0.1-0.5/篇 |
| **一致性** | 中等（受主觀影響） | 高（標準化） |
| **可擴展性** | 低（受限於人力） | 高（無限） |
| **即時反饋** | 否 | 是 |
| **詳細程度** | 取決於老師 | 標準化詳細 |

---

## 應用場景

### 1. 教育機構
- 學校考試自動批改
- 作業快速評分
- 學生寫作能力追蹤

### 2. 補習班
- 大量作文快速批改
- 個性化學習建議
- 寫作進步追蹤

### 3. 線上教育平台
- 即時作文評分
- 自適應學習系統
- 大規模線上考試

### 4. 政府考試
- 初步篩選
- 輔助人工評分
- 提高評分效率

---

## 商業模式

### SaaS 訂閱制

| 方案 | 價格 | 包含 |
|------|------|------|
| **個人版** | $20/月 | 100 篇/月 |
| **教師版** | $50/月 | 500 篇/月 |
| **機構版** | $200/月 | 5,000 篇/月 |
| **企業版** | 報價 | 無限 + API |

### 按量計費

- $0.5/篇（< 1,000 篇）
- $0.3/篇（1,000-10,000 篇）
- $0.1/篇（> 10,000 篇）

---

## 實施建議

### Phase 1：POC（概念驗證）- 1 個月

1. 選擇 ICR 引擎（PaddleOCR）
2. 建立簡單評分規則
3. 測試 50 篇作文
4. 計算準確度

**成功指標：**
- ICR 準確率 > 85%
- 評分準確率 > 70%

---

### Phase 2：MVP - 3 個月

1. 完整系統開發
2. 收集 1,000 篇訓練資料
3. 訓練評分模型
4. 建立 Web 介面

**成功指標：**
- ICR 準確率 > 90%
- 評分準確率 > 80%
- F1 Score > 0.75

---

### Phase 3：優化 - 6 個月

1. 擴大訓練資料（5,000+ 篇）
2. 模型優化
3. 增加詳細評語功能
4. A/B 測試

**成功指標：**
- 評分準確率 > 90%
- F1 Score > 0.85
- 用戶滿意度 > 85%

---

## 預期成果

### 準確度目標

| 指標 | 目標值 | 世界水平 |
|------|-------|---------|
| **ICR 準確率** | 92-95% | 95-98% |
| **評分準確率** | 85-90% | 90-95% |
| **F1 Score** | 0.80-0.85 | 0.85-0.90 |
| **處理速度** | 20-30 秒/篇 | 10-20 秒/篇 |

### ROI 估算

**假設：學校 500 學生，每月 4 次作文**

| 項目 | 人工 | AI | 節省 |
|------|------|----|----|
| 批改篇數 | 2,000 | 2,000 | - |
| 時間成本 | 333 小時 | 16 小時 | 95% |
| 人力成本 | $10,000 | $400 | 96% |

---

## 技術路線圖

### 短期（6 個月）
- [ ] ICR 引擎整合
- [ ] 基礎評分系統
- [ ] Web 介面
- [ ] 評估指標實現

### 中期（1 年）
- [ ] BERT 評分模型
- [ ] 詳細評語生成
- [ ] 多語言支援
- [ ] 行動 App

### 長期（2 年）
- [ ] 多模態評分（結合圖片）
- [ ] 個性化學習建議
- [ ] 自適應評分標準
- [ ] 跨平台整合

---

## 參考文獻

1. **Automated Essay Scoring**
   - Shermis & Burstein (2013)
   - Journal of Writing Assessment

2. **OCR Technology**
   - PaddleOCR: https://github.com/PaddlePaddle/PaddleOCR
   - EasyOCR: https://github.com/JaidedAI/EasyOCR

3. **NLP Evaluation**
   - BERT for Sequence Classification
   - Automated Writing Evaluation (AWE) Systems

---

**下一步：查看完整 Python 實作代碼！**
